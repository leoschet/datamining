<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MC35ML');</script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual:  Progressive Lightmapper</title>
<meta name="description" content="The Unity Manual helps you learn and use the Unity engine. With the Unity engine you can create 2D and 3D games, apps and experiences.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1503756017"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1503756017"></script><script type="text/javascript" src="docdata/toc.js?ts=1503756017"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1503756017"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1503756017">
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-number">Version: <b>2017.1</b> (<a href="https://docs.unity3d.com/2017.2/Documentation/Manual">switch to 2017.2b</a>)</div>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/ProgressiveLightmapper.html">English</a></li>
<li><a href="/ja/current/Manual/ProgressiveLightmapper.html">日本語</a></li>
<li><a href="/es/current/Manual/ProgressiveLightmapper.html">Español</a></li>
<li><a href="/kr/current/Manual/ProgressiveLightmapper.html">한국어</a></li>
<li><a href="/ru/current/Manual/ProgressiveLightmapper.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2017.1)</a></li>
<li><a href="Experimental.html"> Experimental</a></li>
<li> Progressive Lightmapper</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="UIElements.html"></a></span><div class="tip"> Getting started with UIElements</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ScriptedImporters.html"></a></span><div class="tip"> Scripted Importers</div>
</div>
</div></div>
<div class="otherversionswrapper" onmouseover="setOtherVersionsDisplay(true)" onmouseout="setOtherVersionsDisplay(false)">
<a>Other Versions</a><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">Cannot access other versions offline!</div>
</div>
<h1>Progressive Lightmapper</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<h2>What</h2>

<figure>
<img src="../uploads/Main/ProgressiveLightmapper-0.png" alt="">
</figure>

<p>The progressive lightmapper is a path tracing based lightmapper backend that provides baked lightmaps and light probes with progressive updates in the Editor.</p>

<p>The progressive lightmapper goes through a short prepare step (geometry and instance updates, G-buffer and chart mask generation) and starts producing the output very quickly. New lightmaps and light probes are shown as soon as a new intermediate result is ready. This allows for a very fast iteration workflow.</p>

<h2>Why</h2>

<p>The old Enlighten-based lightmapper for baked lightmaps relied on precomputed realtime GI to generate indirect lighting. That was both an advantage, as just changing the lighting could produce new lightmaps fairly quickly, and a disadvantage, as it imposed all the UV layout limitations even for users only interested in baking. The UV requirements in the progressive lightmapper are the usual for baked lightmapping: non-overlapping UVs with small area and angle errors, and sensible padding between the charts.</p>

<p>The new lightmapper starts producing the output immediately and progressively refines it over time for a much improved lighting workflow - this means an interactive lighting workflow. Additionally, baking times are much more predictable.</p>

<p>See an in-depth video showing the interactive workflow <a href="https://youtu.be/IsdH-uOLk2c">here</a>.</p>

<p>Moreover the new technique bakes global illumination at the lightmap resolution - for each texel individually - without upsampling schemes or relying on any irradiance caches or other global data structures. This makes it robust and allows you to bake selected portions of lightmaps, which means that iteration speed can be improved greatly.</p>

<h2>Setup</h2>

<p>Newly created scenes have the progressive lightmapper enabled by default. Existing scenes will stick to Enlighten until you choose the “Progressive (experimental)” Bake Backend.</p>

<h3>Settings</h3>

<figure>
<img src="../uploads/Main/ProgressiveLightmapper-2.png" alt="">
</figure>

<ul>
<li>
<strong>Bake Backend</strong> - “Enlighten” is the old baking backend and “Progressive (experimental)” is the new one.</li>
<li>
<strong>Stationary Lighting Mode: </strong>Specifies which scene lighting mode will be used for all stationary lights in the scene. Options are Baked Indirect, Distance Shadowmask, Shadowmask and Subtractive. Currently light modes are not supported, please be sure to set ‘Baked Indirect’ and do not use ‘Stationary’ lights. The support will come soon.</li>
<li>
<strong>Lightmap Resolution</strong> - The amount of texels per world unit. Keep in mind that increasing this value by two, increases the amount of texels to be calculated by four. Please check the “Occupied texels” count in the stats below.</li>
<li>
<strong>Lightmap Padding</strong> - The padding (in texels) between different instances in the atlas. In order to change padding between UV charts inside an instance please adjust ‘Pack Margin’ on the mesh importer in the Advanced settings under ‘Generate Lightmap UVs’.</li>
<li>
<strong>Compress Lightmaps</strong> - Intermediate lightmaps are not compressed, but the final ones do respect the compression setting.</li>
<li>
<strong>Samples</strong> - The amount of samples (paths) shot from each texel. For some scenes, especially outdoor scenes, 100 samples may be enough. For indoor scenes with emissive geometry more will be needed.</li>
<li>
<strong>Bounces</strong> - Number of indirect bounces to do when tracing paths. For most scenes two bounces is enough. For some indoor scenarios more may be necessary.</li>
<li>
<strong>Filtering</strong> - Configure the post-processing of lightmaps to limit noise. It can be set to None, Auto or Advanced. The Advanced option offers three additional parameters for manual configuration. In Auto mode the default values from the Advanced mode are used.

<ul>
<li>
<strong>Direct Radius: </strong>The radius of the Gauss filter in texels for direct light in the lightmap. A higher radius will increase the blur strength.</li>
<li>
<strong>Indirect Radius: </strong>The radius of the Gauss filter in texels for indirect light in the lightmap. A higher radius will increase the blur strength.</li>
<li>
<strong>AO Radius: </strong>The radius of the Gauss filter in texels for ambient occlusion in the lightmap. A higher radius will increase the blur strength.</li>
</ul>
</li>
<li>
<strong>Prioritize View </strong>- When enabled texels currently visible in scene view camera frustum will be prioritized. When those are done, the lightmapper will continue on all the out-of-view texels.</li>
</ul>

<h3>Stats</h3>

<p>The panel below the ‘Auto Generate’ and ‘Generate Lighting’ options shows the amount of lightmaps that were created, how many are in view (converged / not converged) and out of view (converged / not converged) and the bake performance.</p>

<figure>
<img src="../uploads/Main/ProgressiveLightmapper-3.png" alt="">
</figure>

<h3>Lightmap parameters</h3>

<p>In addition to the Baked GI settings in the Lighting window, there are new parameters in the Lightmap Parameters asset that can be configured. These are Anti-aliasing Samples, Pushoff and Backface Tolerance. Default lightmap parameters can be set for the scene in <em>General GI &gt; Default Parameters</em> or set per renderer.
<img src="../uploads/Main/ProgressiveLightmapper-4.png" alt="">
</p>

<ul>
<li>
<strong>Anti-aliasing Samples </strong>- The number of times to supersample a texel to reduce aliasing. Samples [1;3] disables supersampling, samples [4;8] give 2x supersampling, and samples [9;256] give 4x supersampling. (This is a bit weird UX-wise, we’ll improve on that front.) This mostly affects the amount of memory used for the positions and normals buffers (2x uses four times the amount of memory, 4x uses 16 times the amount of memory).</li>
<li>
<strong>Pushoff </strong>- The amount to push off ray origins away from geometry along the normal for ray tracing, in modelling units. It is applied to all baked lightmaps, so it affects direct light, indirect light and ambient occlusion. It is useful for getting rid of unwanted occlusion/shadowing.</li>
<li>
<strong>Backface Tolerance </strong>- The percentage of rays shot from an output texel that must hit front faces to be considered usable. Allows a texel to be invalidated if too many of the rays cast from it hit backfaces (the texel is inside some geometry). In that case artefacts are avoided by cloning valid values from surrounding texels. For example, if backface tolerance is 0.0, the texel is rejected only if it sees nothing but backfaces. If it is 1.0, the ray origin is rejected if it has even one ray that hits a backface. In the Baked Texel Validity scene view mode one case see valid (green) and invalid (red) texels. If you have a single sided mesh in your scene, you may want to disable this feature by setting it to zero. A two-sided flag will later be added in the editor to address this.</li>
</ul>

<p>The rest is the default Unity 5 workflow. Mark your objects as static and set some light inputs (lights, environment lighting or emissive materials on static objects) as baked.</p>

<p>In “Auto” mode the lightmaps and light probes will be calculated automatically. If you have “Auto” disabled you will need to press the “Build” button for the bake to start.</p>

<h3>Other Features</h3>

<p>
<strong>Force stop:</strong> Allows for stopping the bake at an arbitrary point in time, before the requested amount of samples has actually been done. It works when the lighting is built manually. With the 100,000 max sample count and the ability to disable view prioritization, one can leave the machine baking and just stop whenever the results look pleasing.<img src="../uploads/Main/ProgressiveLightmapper-5.jpg" alt="">
</p>

<p>
<strong>Invalid texels:</strong> Texels are marked as invalid based on the Backface Tolerance parameter (LightmapParameters &gt; General GI) and invalid texels are filled from the valid neighbours. The dilation process that takes care of that does more iterations once the lightmap has converged than when it’s still improving.</p>

<figure>
<img src="../uploads/Main/ProgressiveLightmapper-6.png" alt="">
</figure>

<p>
<strong>Supersampling:</strong> The lighting quality is influenced by the supersampling amount. Control it using the ‘Anti-aliasing Samples’ property (Lightmap Parameters &gt; Baked GI, see the Lightmap Parameters section above).</p>

<h2>Example project</h2>

<p>This <a href="https://drive.google.com/open?id=0BwkcjTqCXtRNaEIxeG5Bdk9FV2M">project</a> is set up with the settings needed for the progressive lightmapper. It is a version of the <a href="https://www.assetstore.unity3d.com/en/#!/content/46209">Tanks!</a> project also available on the Asset Store. It bakes in less than 5 minutes and has 11 1024x1024 lightmaps. Watch a <a href="https://youtu.be/IsdH-uOLk2c">video</a> showing the interactive workflow in this project.</p>

<figure>
<img src="../uploads/Main/ProgressiveLightmapper-8.png" alt="">
</figure>

<figure>
<img src="../uploads/Main/ProgressiveLightmapper-9.png" alt="">
</figure>

<figure>
<img src="../uploads/Main/ProgressiveLightmapper-10.png" alt="">
</figure>

<figure>
<img src="../uploads/Main/ProgressiveLightmapper-11.png" alt="">
</figure>

<hr>

<ul>
<li><p><span class="page-edit">2017–07–04 Page published with no <a href="DocumentationEditorialReview.html">editorial review</a> - <a href="LeaveFeedback.html">Leave page feedback</a>
</span></p></li>
<li><p><span class="page-history">2017–07–04 New feature in Unity 5.6 (Experimental)</span></p></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="UIElements.html"></a></span><div class="tip"> Getting started with UIElements</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ScriptedImporters.html"></a></span><div class="tip"> Scripted Importers</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">
<user_feedback><a href="LeaveFeedback.html" target="_blank">Leave feedback</a></user_feedback><known_issues><p>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at <a href="https://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p></known_issues>Copyright © 2017 Unity Technologies. Publication: 2017.1-001Q. Built: 2017-08-29.</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
